## Load Storm Library
library(Storm)

## create the Storm object
storm <- Storm$new()

## create bolt function
storm$lambda <- function(s){
    tuple <- s$tuple
    s$ack(t)
    words <- unlist(strsplit(tuple, " "))
    sapply(words, function(word){
               tuple$output <- word
               s$emit(tuple)
           })
}
storm$run()
